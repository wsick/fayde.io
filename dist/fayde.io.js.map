{"version":3,"sources":["_version.ts","FileControl.ts","FilesChangedEventArgs.ts","upload/FailedEventArgs.ts","upload/ProgressedEventArgs.ts","upload/Uploader.ts"],"names":["Fayde","Fayde.IO","Fayde.IO.FileControl","Fayde.IO.FileControl.constructor","Fayde.IO.FileControl.OnApplyTemplate","Fayde.IO.FileControl.OnIsMultipleChanged","Fayde.IO.FileControl.OnFilterChanged","Fayde.IO.FileControl.Open","Fayde.IO.FileControl.OnFilesChanged","Fayde.IO.createFileInput","Fayde.IO.FilesChangedEventArgs","Fayde.IO.FilesChangedEventArgs.constructor","Fayde.IO.FailedEventArgs","Fayde.IO.FailedEventArgs.constructor","Fayde.IO.ProgressedEventArgs","Fayde.IO.ProgressedEventArgs.constructor","Fayde.IO.UploadReporting","Fayde.IO.Uploader","Fayde.IO.Uploader.constructor","Fayde.IO.Uploader.Reporting","Fayde.IO.Uploader.Upload"],"mappings":"AAAA,IAAO,KAAK,CAEX;AAFD,WAAO,KAAK;IAACA,IAAAA,EAAEA,CAEdA;IAFYA,WAAAA,EAAEA,EAACA,CAACA;QACFC,UAAOA,GAAGA,OAAOA,CAACA;IACjCA,CAACA,EAFYD,EAAEA,GAAFA,QAAEA,KAAFA,QAAEA,QAEdA;AAADA,CAACA,EAFM,KAAK,KAAL,KAAK,QAEX;;;;;;;ACFD,IAAO,KAAK,CAgFX;AAhFD,WAAO,KAAK;IAACA,IAAAA,EAAEA,CAgFdA;IAhFYA,WAAAA,EAAEA,EAACA,CAACA;QACbC,IAAOA,cAAcA,GAAGA,KAAKA,CAACA,QAAQA,CAACA,cAAcA,CAACA;QACtDA,IAAOA,oBAAoBA,GAAGA,KAAKA,CAACA,WAAWA,CAACA,oBAAoBA,CAACA;QACrEA,IAAOA,UAAUA,GAAGA,KAAKA,CAACA,QAAQA,CAACA,UAAUA,CAACA,UAAUA,CAACA;QAEzDA;YAAiCC,+BAAcA;YAa3CA;gBACIC,iBAAOA,CAACA;gBANZA,iBAAYA,GAAGA,IAAIA,SAASA,CAACA,KAAKA,EAAyBA,CAACA;gBAEpDA,aAAQA,GAAqBA,IAAIA,CAACA;gBAClCA,YAAOA,GAAeA,IAAIA,CAACA;gBAI/BA,IAAIA,CAACA,eAAeA,GAAGA,WAAWA,CAACA;gBACnCA,IAAIA,CAACA,eAAeA,CAACA,WAAWA,CAACA,aAAaA,EAAEA,IAAIA,oBAAoBA,EAAEA,CAACA,CAACA;YAChFA,CAACA;YAEDD,qCAAeA,GAAfA;gBACIE,gBAAKA,CAACA,eAAeA,WAAEA,CAACA;gBACxBA,IAAIA,CAACA,OAAOA,GAAeA,IAAIA,CAACA,gBAAgBA,CAACA,cAAcA,EAAEA,UAAUA,CAACA,CAACA;gBAC7EA,EAAEA,CAACA,CAACA,IAAIA,CAACA,OAAOA,CAACA;oBACbA,IAAIA,CAACA,OAAOA,CAACA,KAAKA,CAACA,EAAEA,CAACA,IAAIA,CAACA,IAAIA,EAAEA,IAAIA,CAACA,CAACA;YAC/CA,CAACA;YAEDF,yCAAmBA,GAAnBA,UAAoBA,QAAiBA,EAAEA,QAAiBA;gBACpDG,IAAIA,EAAEA,GAAGA,IAAIA,CAACA,QAAQA,CAACA;gBACvBA,EAAEA,CAACA,CAACA,EAAEA,CAACA;oBACHA,EAAEA,CAACA,QAAQA,GAAGA,QAAQA,KAAKA,IAAIA,CAACA;YACxCA,CAACA;YAEDH,qCAAeA,GAAfA,UAAgBA,QAAgBA,EAAEA,QAAgBA;gBAC9CI,IAAIA,EAAEA,GAAGA,IAAIA,CAACA,QAAQA,CAACA;gBACvBA,EAAEA,CAACA,CAACA,EAAEA,CAACA,CAACA,CAACA;oBACLA,EAAEA,CAACA,MAAMA,GAAGA,QAAQA,IAAIA,SAASA,CAACA;gBACtCA,CAACA;YACLA,CAACA;YAEDJ,0BAAIA,GAAJA;gBACIK,IAAIA,EAAEA,GAAGA,IAAIA,CAACA,QAAQA,CAACA;gBACvBA,EAAEA,CAACA,CAACA,CAACA,EAAEA,CAACA,CAACA,CAACA;oBACNA,EAAEA,GAAGA,IAAIA,CAACA,QAAQA,GAAGA,eAAeA,CAACA,IAAIA,CAACA,UAAUA,EAAEA,IAAIA,CAACA,MAAMA,CAACA,CAACA;oBACnEA,IAAIA,KAAKA,GAAGA,IAAIA,CAACA;oBACjBA,EAAEA,CAACA,gBAAgBA,CAACA,QAAQA,EAAEA;wBAC1B,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;oBACrC,CAAC,EAAEA,KAAKA,CAACA,CAACA;gBACdA,CAACA;gBACDA,EAAEA,CAACA,KAAKA,GAAGA,IAAIA,CAACA;gBAChBA,EAAEA,CAACA,KAAKA,EAAEA,CAACA;YACfA,CAACA;YAESL,oCAAcA,GAAxBA,UAAyBA,KAAeA;gBACpCM,IAAIA,EAAEA,GAAWA,EAAEA,CAACA;gBACpBA,GAAGA,CAACA,CAACA,GAAGA,CAACA,CAACA,GAAGA,CAACA,EAAEA,CAACA,GAAGA,KAAKA,CAACA,MAAMA,EAAEA,CAACA,EAAEA,EAAEA,CAACA;oBACpCA,EAAEA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA,CAACA,CAACA,CAACA;gBACtBA,CAACA;gBACDA,IAAIA,GAAGA,GAAGA,IAAIA,CAACA,KAAKA,CAACA,OAAOA,EAAEA,CAACA;gBAC/BA,IAAIA,CAACA,KAAKA,CAACA,KAAKA,EAAEA,CAACA;gBACnBA,IAAIA,CAACA,KAAKA,CAACA,QAAQA,CAACA,EAAEA,CAACA,CAACA;gBACxBA,IAAIA,CAACA,YAAYA,CAACA,KAAKA,CAACA,IAAIA,EAAEA,IAAIA,wBAAqBA,CAACA,GAAGA,EAAEA,EAAEA,CAACA,CAACA,CAACA;YACtEA,CAACA;YA5DMN,8BAAkBA,GAAGA,kBAAkBA,CAACA,QAAQA,CAACA,YAAYA,EAAEA,cAAMA,OAAAA,OAAOA,EAAPA,CAAOA,EAAEA,WAAWA,EAAEA,KAAKA,EAAEA,UAACA,CAAcA,EAAEA,IAAIA,IAAKA,OAAAA,CAACA,CAACA,mBAAmBA,CAACA,IAAIA,CAACA,QAAQA,EAAEA,IAAIA,CAACA,QAAQA,CAACA,EAAnDA,CAAmDA,CAACA,CAACA;YACjLA,0BAAcA,GAAGA,kBAAkBA,CAACA,QAAQA,CAACA,QAAQA,EAAEA,cAAMA,OAAAA,MAAMA,EAANA,CAAMA,EAAEA,WAAWA,EAAEA,SAASA,EAAEA,UAACA,CAAcA,EAAEA,IAAIA,IAAKA,OAAAA,CAACA,CAACA,eAAeA,CAACA,IAAIA,CAACA,QAAQA,EAAEA,IAAIA,CAACA,QAAQA,CAACA,EAA/CA,CAA+CA,CAACA,CAACA;YACxKA,yBAAaA,GAAGA,kBAAkBA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,cAAMA,OAAAA,oBAAoBA,EAApBA,CAAoBA,EAAEA,WAAWA,CAACA,CAACA;YA2DjHA,kBAACA;QAADA,CA9DAD,AA8DCC,EA9DgCD,cAAcA,EA8D9CA;QA9DYA,cAAWA,cA8DvBA,CAAAA;QACDA,KAAKA,CAACA,QAAQA,CAACA,aAAaA,CAACA,WAAWA,EACpCA,EAACA,IAAIA,EAAEA,cAAcA,EAAEA,IAAIA,EAAEA,UAAUA,EAACA,CAACA,CAACA;QAE9CA,yBAAyBA,UAAmBA,EAAEA,MAAcA;YACxDQ,IAAIA,EAAEA,GAAGA,QAAQA,CAACA,aAAaA,CAACA,OAAOA,CAACA,CAACA;YACzCA,EAAEA,CAACA,IAAIA,GAAGA,MAAMA,CAACA;YACjBA,EAAEA,CAACA,QAAQA,GAAGA,UAAUA,KAAKA,IAAIA,CAACA;YAClCA,EAAEA,CAACA,MAAMA,GAAGA,MAAMA,IAAIA,SAASA,CAACA;YAChCA,EAAEA,CAACA,KAAKA,CAACA,OAAOA,GAAGA,KAAKA,CAACA;YACzBA,QAAQA,CAACA,IAAIA,CAACA,WAAWA,CAACA,EAAEA,CAACA,CAACA;YAC9BA,MAAMA,CAACA,EAAEA,CAACA;QACdA,CAACA;IACLR,CAACA,EAhFYD,EAAEA,GAAFA,QAAEA,KAAFA,QAAEA,QAgFdA;AAADA,CAACA,EAhFM,KAAK,KAAL,KAAK,QAgFX;AChFD,IAAO,KAAK,CAkBX;AAlBD,WAAO,KAAK;IAACA,IAAAA,EAAEA,CAkBdA;IAlBYA,WAAAA,EAAEA,EAACA,CAACA;QACbC;YAIIS,+BAAYA,QAAgBA,EAAEA,QAAgBA;gBAC1CC,MAAMA,CAACA,gBAAgBA,CAACA,IAAIA,EAAEA;oBAC1BA,UAAUA,EAAEA;wBACRA,KAAKA,EAAEA,QAAQA;wBACfA,QAAQA,EAAEA,KAAKA;qBAClBA;oBACDA,UAAUA,EAAEA;wBACRA,KAAKA,EAAEA,QAAQA;wBACfA,QAAQA,EAAEA,KAAKA;qBAClBA;iBACJA,CAACA,CAAAA;YACNA,CAACA;YACLD,4BAACA;QAADA,CAhBAT,AAgBCS,IAAAT;QAhBYA,wBAAqBA,wBAgBjCA,CAAAA;IACLA,CAACA,EAlBYD,EAAEA,GAAFA,QAAEA,KAAFA,QAAEA,QAkBdA;AAADA,CAACA,EAlBM,KAAK,KAAL,KAAK,QAkBX;AClBD,IAAO,KAAK,CAaX;AAbD,WAAO,KAAK;IAACA,IAAAA,EAAEA,CAadA;IAbYA,WAAAA,EAAEA,EAACA,CAACA;QACbC;YAGIW,yBAAYA,KAAUA;gBAClBC,MAAMA,CAACA,gBAAgBA,CAACA,IAAIA,EAAEA;oBAC1BA,OAAOA,EAAEA;wBACLA,KAAKA,EAAEA,KAAKA;wBACZA,QAAQA,EAAEA,KAAKA;qBAClBA;iBACJA,CAACA,CAAAA;YACNA,CAACA;YACLD,sBAACA;QAADA,CAXAX,AAWCW,IAAAX;QAXYA,kBAAeA,kBAW3BA,CAAAA;IACLA,CAACA,EAbYD,EAAEA,GAAFA,QAAEA,KAAFA,QAAEA,QAadA;AAADA,CAACA,EAbM,KAAK,KAAL,KAAK,QAaX;ACbD,IAAO,KAAK,CAkBX;AAlBD,WAAO,KAAK;IAACA,IAAAA,EAAEA,CAkBdA;IAlBYA,WAAAA,EAAEA,EAACA,CAACA;QACbC;YAIIa,6BAAYA,MAAcA,EAAEA,KAAaA;gBACrCC,MAAMA,CAACA,gBAAgBA,CAACA,IAAIA,EAAEA;oBAC1BA,QAAQA,EAAEA;wBACNA,KAAKA,EAAEA,MAAMA;wBACbA,QAAQA,EAAEA,KAAKA;qBAClBA;oBACDA,OAAOA,EAAEA;wBACLA,KAAKA,EAAEA,KAAKA;wBACZA,QAAQA,EAAEA,KAAKA;qBAClBA;iBACJA,CAACA,CAAAA;YACNA,CAACA;YACLD,0BAACA;QAADA,CAhBAb,AAgBCa,IAAAb;QAhBYA,sBAAmBA,sBAgB/BA,CAAAA;IACLA,CAACA,EAlBYD,EAAEA,GAAFA,QAAEA,KAAFA,QAAEA,QAkBdA;AAADA,CAACA,EAlBM,KAAK,KAAL,KAAK,QAkBX;AClBD,IAAO,KAAK,CAkEX;AAlED,WAAO,KAAK;IAACA,IAAAA,EAAEA,CAkEdA;IAlEYA,WAAAA,EAAEA,EAACA,CAACA;QACbC,WAAYA,eAAeA;YACvBe,6DAAYA,CAAAA;YACZA,6DAAYA,CAAAA;YACZA,yDAAUA,CAAAA;YACVA,+DAAaA,CAAAA;QACjBA,CAACA,EALWf,kBAAeA,KAAfA,kBAAeA,QAK1BA;QALDA,IAAYA,eAAeA,GAAfA,kBAKXA,CAAAA;QAWDA;YAAAgB;gBAAAC,iBAgDCA;gBA3CGA,eAAUA,GAAGA,IAAIA,SAASA,CAACA,KAAKA,EAAuBA,CAACA;gBACxDA,cAASA,GAAGA,IAAIA,SAASA,CAACA,KAAKA,EAAOA,CAACA;gBACvCA,WAAMA,GAAGA,IAAIA,SAASA,CAACA,KAAKA,EAAmBA,CAACA;gBAChDA,cAASA,GAAGA,IAAIA,SAASA,CAACA,KAAKA,EAAOA,CAACA;gBAE/BA,YAAOA,GAAmBA,IAAIA,CAACA;gBAuB/BA,sBAAiBA,GAAGA,UAACA,EAASA;oBAClCA,KAAIA,CAACA,SAASA,CAACA,KAAKA,CAACA,KAAIA,EAAEA,EAAEA,CAACA,CAACA;gBACnCA,CAACA,CAACA;gBAEMA,sBAAiBA,GAAGA,UAACA,EAAiBA;oBAC1CA,KAAIA,CAACA,UAAUA,CAACA,KAAKA,CAACA,KAAIA,EAAEA,IAAIA,sBAAmBA,CAACA,EAAEA,CAACA,MAAMA,EAAEA,EAAEA,CAACA,KAAKA,CAACA,CAACA,CAACA;gBAC9EA,CAACA,CAACA;gBAEMA,qBAAgBA,GAAGA,UAACA,EAAcA;oBACtCA,KAAIA,CAACA,MAAMA,CAACA,KAAKA,CAACA,KAAIA,EAAEA,IAAIA,kBAAeA,CAACA,EAAEA,CAACA,CAACA,CAACA;gBACrDA,CAACA,CAACA;gBAEMA,qBAAgBA,GAAGA,UAACA,EAAWA;oBACnCA,KAAIA,CAACA,SAASA,CAACA,KAAKA,CAACA,KAAIA,EAAEA,EAAEA,CAACA,CAACA;gBACnCA,CAACA,CAACA;YACNA,CAACA;YA/CGD,sBAAIA,+BAASA;qBAAbA;oBACIE,MAAMA,CAACA,eAAeA,CAACA,QAAQA,GAAGA,eAAeA,CAACA,QAAQA,GAAGA,eAAeA,CAACA,MAAMA,GAAGA,eAAeA,CAACA,SAASA,CAACA;gBACpHA,CAACA;;;eAAAF;YASDA,yBAAMA,GAANA,UAAOA,GAAWA,EAAEA,IAASA,EAAEA,QAAgBA,EAAEA,QAAgBA;gBAC7DG,EAAEA,CAACA,CAACA,IAAIA,CAACA,OAAOA,CAACA;oBACbA,MAAMA,IAAIA,KAAKA,CAACA,gCAAgCA,CAACA,CAACA;gBACtDA,IAAIA,GAAGA,GAAGA,IAAIA,CAACA,OAAOA,GAAGA,IAAIA,cAAcA,EAAEA,CAACA;gBAC9CA,GAAGA,CAACA,IAAIA,CAACA,MAAMA,EAAEA,GAAGA,EAAEA,IAAIA,CAACA,CAACA;gBAE5BA,GAAGA,CAACA,gBAAgBA,CAACA,aAAaA,EAAEA,QAAQA,CAACA,CAACA;gBAC9CA,GAAGA,CAACA,gBAAgBA,CAACA,aAAaA,EAAEA,QAAQA,CAACA,CAACA;gBAE9CA,EAAEA,CAACA,CAACA,GAAGA,CAACA,MAAMA,CAACA,CAACA,CAACA;oBACbA,GAAGA,CAACA,MAAMA,CAACA,gBAAgBA,CAACA,MAAMA,EAAEA,IAAIA,CAACA,iBAAiBA,EAAEA,KAAKA,CAACA,CAACA;oBACnEA,GAAGA,CAACA,MAAMA,CAACA,gBAAgBA,CAACA,UAAUA,EAAEA,IAAIA,CAACA,iBAAiBA,EAAEA,KAAKA,CAACA,CAACA;oBACvEA,GAAGA,CAACA,MAAMA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,gBAAgBA,EAAEA,KAAKA,CAACA,CAACA;oBACnEA,GAAGA,CAACA,MAAMA,CAACA,gBAAgBA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,gBAAgBA,EAAEA,KAAKA,CAACA,CAACA;gBACvEA,CAACA;gBAEDA,IAAIA,KAAKA,GAAGA,IAAIA,QAAQA,EAAEA,CAACA;gBAC3BA,KAAKA,CAACA,MAAMA,CAACA,OAAOA,EAAEA,IAAIA,CAACA,CAACA;gBAC5BA,GAAGA,CAACA,IAAIA,CAACA,KAAKA,CAACA,CAACA;YACpBA,CAACA;YAiBLH,eAACA;QAADA,CAhDAhB,AAgDCgB,IAAAhB;QAhDYA,WAAQA,WAgDpBA,CAAAA;IACLA,CAACA,EAlEYD,EAAEA,GAAFA,QAAEA,KAAFA,QAAEA,QAkEdA;AAADA,CAACA,EAlEM,KAAK,KAAL,KAAK,QAkEX","file":"fayde.io.js","sourcesContent":["module Fayde.IO {\r\n    export var version = '0.1.0';\r\n}","module Fayde.IO {\r\n    import ContentControl = Fayde.Controls.ContentControl;\r\n    import ObservableCollection = Fayde.Collections.ObservableCollection;\r\n    import ButtonBase = Fayde.Controls.Primitives.ButtonBase;\r\n\r\n    export class FileControl extends ContentControl {\r\n        static IsMultipleProperty = DependencyProperty.Register(\"IsMultiple\", () => Boolean, FileControl, false, (d: FileControl, args) => d.OnIsMultipleChanged(args.OldValue, args.NewValue));\r\n        static FilterProperty = DependencyProperty.Register(\"Filter\", () => String, FileControl, undefined, (d: FileControl, args) => d.OnFilterChanged(args.OldValue, args.NewValue));\r\n        static FilesProperty = DependencyProperty.RegisterReadOnly(\"Files\", () => ObservableCollection, FileControl);\r\n        IsMultiple: boolean;\r\n        Filter: string;\r\n        Files: ObservableCollection<File>;\r\n\r\n        FilesChanged = new nullstone.Event<FilesChangedEventArgs>();\r\n\r\n        private $element: HTMLInputElement = null;\r\n        private $button: ButtonBase = null;\r\n\r\n        constructor() {\r\n            super();\r\n            this.DefaultStyleKey = FileControl;\r\n            this.SetCurrentValue(FileControl.FilesProperty, new ObservableCollection());\r\n        }\r\n\r\n        OnApplyTemplate() {\r\n            super.OnApplyTemplate();\r\n            this.$button = <ButtonBase>this.GetTemplateChild(\"BrowseButton\", ButtonBase);\r\n            if (this.$button)\r\n                this.$button.Click.on(this.Open, this);\r\n        }\r\n\r\n        OnIsMultipleChanged(oldValue: boolean, newValue: boolean) {\r\n            var el = this.$element;\r\n            if (el)\r\n                el.multiple = newValue === true;\r\n        }\r\n\r\n        OnFilterChanged(oldValue: string, newValue: string) {\r\n            var el = this.$element;\r\n            if (el) {\r\n                el.accept = newValue || undefined;\r\n            }\r\n        }\r\n\r\n        Open() {\r\n            var el = this.$element;\r\n            if (!el) {\r\n                el = this.$element = createFileInput(this.IsMultiple, this.Filter);\r\n                var _this = this;\r\n                el.addEventListener('change', function () {\r\n                    _this.OnFilesChanged(this.files);\r\n                }, false);\r\n            }\r\n            el.files = null;\r\n            el.click();\r\n        }\r\n\r\n        protected OnFilesChanged(files: FileList) {\r\n            var fs: File[] = [];\r\n            for (var i = 0; i < files.length; i++) {\r\n                fs.push(files[i]);\r\n            }\r\n            var old = this.Files.ToArray();\r\n            this.Files.Clear();\r\n            this.Files.AddRange(fs);\r\n            this.FilesChanged.raise(this, new FilesChangedEventArgs(old, fs));\r\n        }\r\n    }\r\n    Fayde.Controls.TemplateParts(FileControl,\r\n        {Name: \"BrowseButton\", Type: ButtonBase});\r\n\r\n    function createFileInput(isMultiple: boolean, filter: string): HTMLInputElement {\r\n        var el = document.createElement('input');\r\n        el.type = \"file\";\r\n        el.multiple = isMultiple === true;\r\n        el.accept = filter || undefined;\r\n        el.style.opacity = \"0.0\";\r\n        document.body.appendChild(el);\r\n        return el;\r\n    }\r\n}","module Fayde.IO {\r\n    export class FilesChangedEventArgs implements nullstone.IEventArgs {\r\n        OldFiles: File[];\r\n        NewFiles: File[];\r\n\r\n        constructor(oldFiles: File[], newFiles: File[]) {\r\n            Object.defineProperties(this, {\r\n                \"OldFiles\": {\r\n                    value: oldFiles,\r\n                    writable: false\r\n                },\r\n                \"NewFiles\": {\r\n                    value: newFiles,\r\n                    writable: false\r\n                }\r\n            })\r\n        }\r\n    }\r\n}","module Fayde.IO {\r\n    export class FailedEventArgs implements nullstone.IEventArgs {\r\n        Error: any;\r\n\r\n        constructor(error: any) {\r\n            Object.defineProperties(this, {\r\n                \"Error\": {\r\n                    value: error,\r\n                    writable: false\r\n                }\r\n            })\r\n        }\r\n    }\r\n}","module Fayde.IO {\r\n    export class ProgressedEventArgs implements nullstone.IEventArgs {\r\n        Loaded: number;\r\n        Total: number;\r\n\r\n        constructor(loaded: number, total: number) {\r\n            Object.defineProperties(this, {\r\n                \"Loaded\": {\r\n                    value: loaded,\r\n                    writable: false\r\n                },\r\n                \"Total\": {\r\n                    value: total,\r\n                    writable: false\r\n                }\r\n            })\r\n        }\r\n    }\r\n}","module Fayde.IO {\r\n    export enum UploadReporting {\r\n        Complete = 1,\r\n        Progress = 2,\r\n        Failed = 4,\r\n        Cancelled = 8\r\n    }\r\n\r\n    export interface IUploader {\r\n        Reporting: UploadReporting;\r\n        Progressed: nullstone.Event<ProgressedEventArgs>;\r\n        Completed: nullstone.Event<any>;\r\n        Failed: nullstone.Event<FailedEventArgs>;\r\n        Cancelled: nullstone.Event<any>;\r\n        Upload(url: string, data: any, filename: string, filetype: string);\r\n    }\r\n\r\n    export class Uploader implements IUploader {\r\n        get Reporting(): UploadReporting {\r\n            return UploadReporting.Complete | UploadReporting.Progress | UploadReporting.Failed | UploadReporting.Cancelled;\r\n        }\r\n\r\n        Progressed = new nullstone.Event<ProgressedEventArgs>();\r\n        Completed = new nullstone.Event<any>();\r\n        Failed = new nullstone.Event<FailedEventArgs>();\r\n        Cancelled = new nullstone.Event<any>();\r\n\r\n        private $active: XMLHttpRequest = null;\r\n\r\n        Upload(url: string, data: any, filename: string, filetype: string) {\r\n            if (this.$active)\r\n                throw new Error(\"Uploader can only upload once.\");\r\n            var xhr = this.$active = new XMLHttpRequest();\r\n            xhr.open(\"POST\", url, true);\r\n            //xhr.setRequestHeader(\"Content-Type\", \"multipart/form-data\");\r\n            xhr.setRequestHeader(\"X-File-Name\", filename);\r\n            xhr.setRequestHeader(\"X-File-Type\", filetype);\r\n\r\n            if (xhr.upload) {\r\n                xhr.upload.addEventListener(\"load\", this._OnUploadComplete, false);\r\n                xhr.upload.addEventListener(\"progress\", this._OnUploadProgress, false);\r\n                xhr.upload.addEventListener(\"error\", this._OnUploadErrored, false);\r\n                xhr.upload.addEventListener(\"abort\", this._OnUploadAborted, false);\r\n            }\r\n\r\n            var fdata = new FormData();\r\n            fdata.append('image', data);\r\n            xhr.send(fdata);\r\n        }\r\n\r\n        private _OnUploadComplete = (ev: Event) => {\r\n            this.Completed.raise(this, {});\r\n        };\r\n\r\n        private _OnUploadProgress = (ev: ProgressEvent) => {\r\n            this.Progressed.raise(this, new ProgressedEventArgs(ev.loaded, ev.total));\r\n        };\r\n\r\n        private _OnUploadErrored = (ev: ErrorEvent) => {\r\n            this.Failed.raise(this, new FailedEventArgs(ev));\r\n        };\r\n\r\n        private _OnUploadAborted = (ev: UIEvent) => {\r\n            this.Cancelled.raise(this, {});\r\n        };\r\n    }\r\n}"],"sourceRoot":"/source/"}