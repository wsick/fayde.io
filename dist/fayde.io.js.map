{"version":3,"sources":["_version.ts","FileControl.ts","FilesChangedEventArgs.ts"],"names":["Fayde","Fayde.IO","Fayde.IO.FileControl","Fayde.IO.FileControl.constructor","Fayde.IO.FileControl.OnApplyTemplate","Fayde.IO.FileControl.OnIsMultipleChanged","Fayde.IO.FileControl.OnFilterChanged","Fayde.IO.FileControl.Open","Fayde.IO.FileControl.OnFilesChanged","Fayde.IO.createFileInput","Fayde.IO.FilesChangedEventArgs","Fayde.IO.FilesChangedEventArgs.constructor"],"mappings":"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","file":"fayde.io.js","sourcesContent":["module Fayde.IO {\r\n    export var version = '0.1.0';\r\n}","module Fayde.IO {\r\n    import Control = Fayde.Controls.Control;\r\n    import ObservableCollection = Fayde.Collections.ObservableCollection;\r\n    import ButtonBase = Fayde.Controls.Primitives.ButtonBase;\r\n\r\n    export class FileControl extends Control {\r\n        static IsMultipleProperty = DependencyProperty.Register(\"IsMultiple\", () => Boolean, FileControl, false, (d: FileControl, args) => d.OnIsMultipleChanged(args.OldValue, args.NewValue));\r\n        static FilterProperty = DependencyProperty.Register(\"Filter\", () => String, FileControl, undefined, (d: FileControl, args) => d.OnFilterChanged(args.OldValue, args.NewValue));\r\n        static FilesProperty = DependencyProperty.RegisterReadOnly(\"Files\", () => ObservableCollection, FileControl);\r\n        IsMultiple: boolean;\r\n        Filter: string;\r\n        Files: ObservableCollection<File>;\r\n\r\n        FilesChanged = new nullstone.Event<FilesChangedEventArgs>();\r\n\r\n        private $element: HTMLInputElement = null;\r\n        private $button: ButtonBase = null;\r\n\r\n        constructor() {\r\n            super();\r\n            this.DefaultStyleKey = FileControl;\r\n            this.SetCurrentValue(FileControl.FilesProperty, new ObservableCollection());\r\n        }\r\n\r\n        OnApplyTemplate() {\r\n            super.OnApplyTemplate();\r\n            this.$button = <ButtonBase>this.GetTemplateChild(\"BrowseButton\", ButtonBase);\r\n            if (this.$button)\r\n                this.$button.Click.on(this.Open, this);\r\n        }\r\n\r\n        OnIsMultipleChanged(oldValue: boolean, newValue: boolean) {\r\n            var el = this.$element;\r\n            if (el)\r\n                el.multiple = newValue === true;\r\n        }\r\n\r\n        OnFilterChanged(oldValue: string, newValue: string) {\r\n            var el = this.$element;\r\n            if (el) {\r\n                el.accept = newValue || undefined;\r\n            }\r\n        }\r\n\r\n        Open() {\r\n            var el = this.$element;\r\n            if (!el) {\r\n                el = this.$element = createFileInput(this.IsMultiple, this.Filter);\r\n                var _this = this;\r\n                el.addEventListener('change', function () {\r\n                    _this.OnFilesChanged(this.files);\r\n                }, false);\r\n            }\r\n            el.files = null;\r\n            el.click();\r\n        }\r\n\r\n        protected OnFilesChanged(files: FileList) {\r\n            var fs: File[] = [];\r\n            for (var i = 0; i < files.length; i++) {\r\n                fs.push(files[i]);\r\n            }\r\n            var old = this.Files.ToArray();\r\n            this.Files.Clear();\r\n            this.Files.AddRange(fs);\r\n            this.FilesChanged.raise(this, new FilesChangedEventArgs(old, fs));\r\n        }\r\n    }\r\n    Fayde.Controls.TemplateParts(FileControl,\r\n        {Name: \"BrowseButton\", Type: ButtonBase});\r\n\r\n    function createFileInput(isMultiple: boolean, filter: string): HTMLInputElement {\r\n        var el = document.createElement('input');\r\n        el.type = \"file\";\r\n        el.multiple = isMultiple === true;\r\n        el.accept = filter || undefined;\r\n        el.style.opacity = \"0.0\";\r\n        document.body.appendChild(el);\r\n        return el;\r\n    }\r\n}","module Fayde.IO {\r\n    export class FilesChangedEventArgs implements nullstone.IEventArgs {\r\n        OldFiles: File[];\r\n        NewFiles: File[];\r\n\r\n        constructor(oldFiles: File[], newFiles: File[]) {\r\n            Object.defineProperties(this, {\r\n                \"OldFiles\": {\r\n                    value: oldFiles,\r\n                    writable: false\r\n                },\r\n                \"NewFiles\": {\r\n                    value: newFiles,\r\n                    writable: false\r\n                }\r\n            })\r\n        }\r\n    }\r\n}"],"sourceRoot":"/source/"}